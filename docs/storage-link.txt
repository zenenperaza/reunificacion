borrar public/storage

ejecutar

Route::get('/fix-storage-link', function () {
    try {
        // Elimina el enlace si existe
        $publicStorage = public_path('storage');
        if (file_exists($publicStorage)) {
            unlink($publicStorage); // elimina el symlink
        }

        // Crea el nuevo enlace simbólico correctamente
        Artisan::call('storage:link');

        return "✅ Enlace simbólico 'public/storage' recreado con éxito.";
    } catch (\Exception $e) {
        return " Error al recrear el enlace: " . $e->getMessage();
    }
});

subir manual 
storage/app/public

poner permisos 777 a storage/app/public

Route::get('/limpiar-config', function () {
    Artisan::call('config:clear');
    Artisan::call('cache:clear');
    return 'Configuración y caché limpiadas.';
});

Route::get('/fix-permisos', function () {
    $paths = [
        storage_path(),
        storage_path('framework'),
        storage_path('framework/views'),
        base_path('bootstrap/cache')
    ];

    foreach ($paths as $path) {
        if (file_exists($path)) {
            chmod($path, 0775);
        }
    }

    Artisan::call('view:clear');
    Artisan::call('config:clear');
    Artisan::call('cache:clear');

    return '✔️ Permisos y cachés corregidos.';
});


Route::get('/fix-storage-permisos', function () {
    try {
        $path = storage_path('app/public');
        chmod($path, 0775); // Carpeta base
        foreach (new RecursiveIteratorIterator(new RecursiveDirectoryIterator($path)) as $file) {
            chmod($file, 0644); // Archivos
        }
        return '✅ Permisos corregidos.';
    } catch (\Exception $e) {
        return '❌ Error: ' . $e->getMessage();
    }
});



Route::get('/run-migrate-fresh', function () {
    // SOLO USAR EN LOCAL O ENTORNOS CONTROLADOS
    #if (app()->environment('local', 'staging') && Auth::check() && Auth::user()->email === 'zenenperaza@gmail.com') {
       try {
            Artisan::call('migrate:fresh', [
                '--seed' => true,
                '--force' => true,
            ]);

            return '✅ Migraciones reiniciadas y seeders ejecutados.';
        } catch (\Exception $e) {
            return '❌ Error: ' . $e->getMessage();
        }
   # }

  #  abort(403, 'No autorizado');
});

